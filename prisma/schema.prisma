// generator client {
//   provider      = "prisma-client-js"
//   output        = "../lib/generated/prisma"
//   plugins       = ["@prisma/nextjs-monorepo-workaround-plugin"]
//   binaryTargets = ["native"]
// }
generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model users {
  id         String         @id
  created_at DateTime       @default(now()) @db.Timestamptz(6)
  updated_at DateTime?      @default(now()) @db.Timestamp(6)
  email      String         @unique
  nickname   String?
  role       EnumRole       @default(GUEST)
  status     EnumUserStatus @default(JOIN)
  plan       EnumPlan       @default(BASICS)
  feed       feed[]
  event      offline[]
}

model feed {
  id String @id @default(uuid())

  created_at DateTime  @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)
  content    String
  images     String[]

  user    users  @relation(fields: [usersId], references: [id])
  usersId String
  tags    tag[]
}

model tag {
  id   String @id @default(uuid())
  name String @unique

  feeds feed[]
}

/// 행사(Event) 모델
model offline {
  id String @id @default(uuid())

  // 메타
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @updatedAt @db.Timestamptz(6)

  // 기본 정보
  title   String // 행사명
  posters String[] // 행사 포스터 이미지 URL (1~10장: 앱/서버에서 검증)
  content String   @db.Text // 내용(에디터 본문)

  // 기간
  startDate DateTime @db.Timestamptz(6) // 시작일 (날짜 용도, 시간은 00:00로 맞춰 사용 권장)
  endDate   DateTime @db.Timestamptz(6) // 종료일

  // 시간(하루 내 시작/마감 시각)
  startTime DateTime @db.Time(6) // 행사 시작시간 (Postgres TIME)
  endTime   DateTime @db.Time(6) // 행사 마감시간  (Postgres TIME)

  // 장소
  placeName String // 장소명(직접 입력)
  address   String // 주소(도로명 등)

  // 금액
  price   Decimal @db.Decimal(12, 2) // 금액 (원화면 정수만 쓰더라도 Decimal 권장)
  users   users   @relation(fields: [usersId], references: [id])
  usersId String
}

enum EnumRole {
  GUEST
  BUSINESS
  ADMIN
}

enum EnumUserStatus {
  JOIN
  WITHDRAW
}

enum EnumPlan {
  BASICS
  PLUS
  PREMIUM
}

/**
 * npx prisma init  ##prisma 초기화
 * npx prisma migrate dev ##DB를 수정
 */
